with open("data.bin", "rb") as f:
    data = f.read()
cmp_length = 0
for i in data:
    if i == 2:
        cmp_length += 1     # 长度31


v3_data = [20,226,96,29,42,92,30,160,93,110,152,105,232,157,171,220,169,39,229,230,40,233,103,41,35,117,34,168,117,102,180,98,240,177,162,244,114,48,237,238,44,177,111,49,45,107,252,169,111,125,174,56,233,183,184,234,124,58,247,244,182,179,122,55,57,2,244,194,120,117,71,52,1,255,193,131,116,65,67,252,190,204,130,127,65,254,11,185,201,127,60,78,251,10,199,137,138,60,73,7,197,198,147,137,70,8,2,212,193,146,20,70,20,2,207,81,14,83,82,19,141,78,139,157,79,208,158,203,217,138,13,222,14,28,201]
print(len(v3_data))
v3_data = [196,204,33,192,170,198,229,124,141,124,172,156,1,156,178,201,147,193,85,15,123,129,188,63,215,172,168,223,171,89,2,8,211,177,163,88,234,81,72,4,167,63,85,111,70,231,74,69,230,115,188,107,173,225,199,230,15,230,45,242,215,70,28,31,192,253,141,207,126,174,112,87,167,217,35,217,22,200,111,28,148,143,98,242,45,31,66,31,41,152,136,123,179,121,7,14,30,208,139,137,133,27,64,27,225,77,77,146,252,213,236,129,241,117,59,175,93,7,42,105,13,123,78,77,74,50,174,148,109,90,39,14,90,189,89]
print(len(v3_data))
idx3 = -1
flag = []
k = 0
for i in range(len(data)):
    if data[i] == 3:
        idx3 += 1
    if data[i] == 2:
        j = i - 1
        num = data[i+1]
        k += 1
        jdx3 = idx3
        while data[j] != 1:
            if data[j] == 0xa4:
                num = (num - v3_data[jdx3]) & 0xff
                jdx3 -= 1
            elif data[j] == 0x37:
                num ^= v3_data[jdx3]
                jdx3 -= 1
            elif data[j] == 0x2c:
                num = (num + v3_data[jdx3]) & 0xff
                jdx3 -= 1
            elif data[j] == 4:
                num = ~num & 0xff
            j -= 1
        flag += [num]
for i in range(0, len(bytes(flag).hex()), 2):
    print(bytes(flag).hex()[i:i+2], end=" ")

# s = bytes.fromhex("443D4B073B474A484B4D4C394C4B073E").decode()
# s1 = ""
# for i in range(len(s)):
#     s1 += chr(ord(s[i])+40)
# s = bytes.fromhex("16262B123427252334").decode()
# print(s1[::-1])
# s1 = ""
# for i in range(len(s)):
#     s1 += chr(ord(s[i])+62)
# print(s1[::-1])

